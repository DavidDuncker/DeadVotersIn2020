function CreateMap(){initialViewZoomLevel=15;minimumViewZoomLevel=6;maximumViewZoomLevel=23;directionOptions={credentials:"AkGcMAL0Mi6vh0-DpI500TDfbII91OR1klN59xr58ckkY_qxXegOkHcIN9AEZ1Fo",showLocateMeButton:!1,showScalebar:!1,showTermsLink:!1,showCopyright:!1,showLogo:!1,liteMode:!0};mapOptions={credentials:"AkGcMAL0Mi6vh0-DpI500TDfbII91OR1klN59xr58ckkY_qxXegOkHcIN9AEZ1Fo",showLocateMeButton:!1,showScalebar:!1,showTermsLink:!1,showCopyright:!1,showLogo:!1,liteMode:!0};pinOptions={draggable:!1,text:"",textOffset:0,visible:!0,icon:"/Content/Images/pushPin.png"};$("#hfPageName").val()==="registeredvoter"&&(LoadPollMapValues(),BuildPollMap());LoadClerkMapValues();BuildClerkMap();CloseRouteRequestBox()}function BuildPollMap(){pollMap!==null&&(pollMap.dispose(),pollMap=null);pollLat!="0"&&pollLat!=""&&pollLong!="0"&&pollLong!=""&&(pollMap=new Microsoft.Maps.Map(pollMapDiv,mapOptions),AddPinAndInfoBox(pollLat,pollLong,pollMap,"poll",pollRouteRequestTitle,pollingAddress))}function BuildClerkMap(){clerkMap!==null&&(clerkMap.dispose(),clerkMap=null);clerkLat!="0"&&clerkLat!=""&&clerkLong!="0"&&clerkLong!=""&&(clerkMap=new Microsoft.Maps.Map(clerkMapDiv,mapOptions),AddPinAndInfoBox(clerkLat,clerkLong,clerkMap,"clerk",clerkRouteRequestTitle,clerkAddress))}function LoadClerkMapValues(){clerkRouteRequestTitle=$("#hfClerkRouteRequestTitle").val();clerkAddress=$("#hfClerkAddress").val();clerkCityStateZip=$("#hfClerkCityStateZip").val();clerkLat=$("#hfClerkLatitude").val();clerkLong=$("#hfClerkLongitude").val()}function LoadPollMapValues(){pollRouteRequestTitle=$("#hfPollRouteRequestTitle").val();pollingAddress=$("#hfPollingAddress").val();pollingCityStateZip=$("#hfPollingCityStateZip").val();pollLat=$("#hfPollLatitude").val();pollLong=$("#hfPollLongitude").val()}function AddPinAndInfoBox(n,t,i,r,u,f){var o=new Microsoft.Maps.Location(n,t),s=new Microsoft.Maps.Pushpin(o,pinOptions),e,h;Microsoft.Maps.Events.addHandler(s,"click",function(){PinClick(r)});i.entities.push(s);e=new Microsoft.Maps.Location(n,t);e.latitude=e.latitude-.0035;e.longitude=e.longitude-.00375;h=new Microsoft.Maps.Infobox(e,{title:u,description:f,showPointer:!1});h.setMap(i);i.setOptions({minZoom:minimumViewZoomLevel,maxZoom:maximumViewZoomLevel});i.setView({center:o,zoom:initialViewZoomLevel})}function PinClick(n){DisplayRouteRequestDialog(n)}function DisplayRouteRequestDialog(n){$("#hfMapType").val(n);n==="poll"?($("#RouteRequestTitle").html(pollRouteRequestTitle),$("#RouteRequestDetail1").html(pollingAddress),$("#RouteRequestDetail2").html(pollingCityStateZip)):($("#RouteRequestTitle").html(clerkRouteRequestTitle),$("#RouteRequestDetail1").html(clerkAddress),$("#RouteRequestDetail2").html(clerkCityStateZip));$("#RouteRequest").modal("show");$("#StartingPoint").html("");setTimeout(function(){$("#StartingPoint").focus()},1)}function CloseRouteRequestBox(){$("#RouteRequestTitle").html("");$("#RouteRequestDetail1").html("");$("#RouteRequestDetail2").html("");$("#StartingPoint").html("");$("#RouteRequest").modal("hide")}function GetDirections(){(searchText=$("#StartingPoint").val(),searchText)&&($("#StartingPoint").val(""),$("#RouteRequestTitle").val(""),$("#routeDirectionsItinerary").html(""),$("#hfMapType").val()==="poll"?(routeLat=pollLat,routeLong=pollLong,routeAddress=pollRouteRequestTitle,$("#DirectionsTitle").text(pollingAddress+", "+pollingCityStateZip),RouteDirections()):(routeLat=clerkLat,routeLong=clerkLong,routeAddress=clerkRouteRequestTitle,$("#DirectionsTitle").text(clerkAddress+", "+clerkCityStateZip),RouteDirections()))}function RouteDirections(){var n;routeMap?(routeMap.layers.clear(),n=new Microsoft.Maps.Layer,routeMap.layers.insert(n),routeMap.setView({zoom:minimumViewZoomLevel})):(routeMap=new Microsoft.Maps.Map(routeMapDiv,directionOptions),n=new Microsoft.Maps.Layer,routeMap.layers.insert(n),routeMap.setView({zoom:minimumViewZoomLevel}));Microsoft.Maps.loadModule("Microsoft.Maps.Directions",function(){var n=new Microsoft.Maps.Directions.Waypoint({address:searchText}),t=new Microsoft.Maps.Directions.Waypoint({address:routeAddress,location:new Microsoft.Maps.Location(routeLat,routeLong)});routeDirectionsManager=new Microsoft.Maps.Directions.DirectionsManager(routeMap);routeDirectionsManager.clearAll();routeDirectionsManager.addWaypoint(n);routeDirectionsManager.addWaypoint(t);routeDirectionsManager.setRenderOptions({itineraryContainer:routeDirectionsItinerary});routeDirectionsManager.calculateDirections();routeDirectionsManager.setRequestOptions({routeMode:Microsoft.Maps.Directions.RouteMode.driving})});routeMap.setView({zoom:minimumViewZoomLevel});$("#RouteRequest").modal("hide");$("#RouteContainer").modal("show")}function PrintRoute(n,t){var u=window.screen.width,f=window.screen.height,i=u/2-512,r=f/2-480,e="printMap.aspx?lat="+n+"&long="+t+"&searchText="+searchText,o=window.open(e,"","width=1024,height=768,toolbar=0,location=0,directories=0,status=0,scrollbars=1,menubar=0,resizable=1,left="+i+",top="+r+",screenX="+i+",screenY="+r+",")}var clerkMap=null,clerkLat=null,clerkLong=null,clerkDirectionsManager=null,clerkRouteRequestTitle=null,clerkAddress=null,clerkCityStateZip=null,clerkMapDiv="#clerkMap",pollMap=null,pollLat=null,pollLong=null,pollDirectionsManager=null,pollRouteRequestTitle=null,pollingAddress=null,pollingCityStateZip=null,pollMapDiv="#pollMap",routeMap=null,routeLat=null,routeLong=null,routeAddress=null,routeDirectionsManager=null,routeMapDiv="#routeMap",routeDirectionsContainer="#routeDirectionsContainer",routeDirectionsItinerary="#routeDirectionsItinerary",infoboxTemplate='<div class="customInfobox"><div class="title">{title}<\/div>{description}<\/div>',initialViewZoomLevel=null,minimumViewZoomLevel=null,maximumViewZoomLevel=null,pinOptions=null,mapOptions=null,directionOptions=null,directionsManager=null,searchText=null;bing8_on_ready=jQuery.Deferred();GetMap=function(){bing8_on_ready.resolve()};jQuery.when(bing8_on_ready).then(function(){CreateMap()});$(document).ready(function(){$("#StartingPoint").keypress(function(n){n.which===13&&(n.preventDefault(),$("#RouteRequestSubmit").click())});$("#btnRouteRequest").on("click",function(){GetDirections()})})